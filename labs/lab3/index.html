<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
  </head>
  <body>
    <canvas id="myCanvas"></canvas>
    <script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous">
      </script>
    <script>
      var c=document.getElementById("myCanvas");
      var ctx=c.getContext("2d");
      ctx.fillStyle = "blue";
      
      var circleX = c.width;
      
      var game = {livesLeft: 3, score: 0, state: "play", level: 1};
      var benefit = {x: c.width, y: 50, color:"yellow", radius: 25};
      var harm = {x: c.width, y: 100, color:"blue", radius: 25};
      var player = {x: 75, y: 110, color:"green", radius: 25}; 
      
      
      function draw() {
        
        
        ctx.clearRect(0,0,c.width,c.height);
        
        ctx.font = "8px Times verdana";
        ctx.fillText("Lives: " + game.livesLeft + " Score: " + game.score,10,50);
        
        //draw harm
        
        harm.x -= (game.level);
        benefit.x--;
        
        
        if(harm.x <= 0) {
          harm.y = Math.floor((Math.random() * c.height) + 1);
          harm.x = c.width;
        }
        
        if(benefit.x <= 0) {
          benefit.x = c.width;
          benefit.y = Math.floor((Math.random() * c.height) + 1);
        }
        
        ctx.fillStyle = benefit.color;
        ctx.beginPath();
        ctx.arc(benefit.x,benefit.y,benefit.radius,0,2*Math.PI);
        ctx.fill();
        
        ctx.fillStyle = harm.color;
        ctx.beginPath();
        ctx.arc(harm.x,harm.y,harm.radius,0,2*Math.PI);
        ctx.fill();
        
        //draw player
        ctx.fillStyle = player.color;
        ctx.beginPath();
        ctx.arc(player.x,player.y,player.radius,0,2*Math.PI);
        ctx.fill();
        
        
        var dx = player.x - harm.x;
        var dy = player.y - harm.y;
        var distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < player.radius + harm.radius) {
            game.livesLeft--;
  //          console.log("collision");
            harm.y = Math.floor((Math.random() * c.height) + 1);
            harm.x = c.width;
            if(game.livesLeft == 0){
              game.state = "over";
              ctx.clearRect(0,0,c.width,c.height);
              ctx.fillStyle = "black";
              ctx.fillRect(0,0,c.width,c.height);
              
              ctx.font = "30px Verdana";
              ctx.fillStyle = "Yellow";
              ctx.fillText("Game Over! ",10,50);
              
            }
        }
        
        var dx2 = player.x - benefit.x;
        var dy2 = player.y - benefit.y;
        var distance2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);
        
        if (distance2 < player.radius + benefit.radius) {
  //          console.log("collision");
            game.score+=100;
            benefit.x = c.width;
            benefit.y = Math.floor((Math.random() * c.height) + 1);
            if(game.score % 100 == 0) {
              game.level++;
            }
        }
        
        if(game.state == "play") {
          requestAnimationFrame(draw);
        }
      }
      $(document).keydown(function(e) {
      //      console.log(e);
            switch(e.which) {
                case 37: // left
                break;
        
                case 38: // up
                player.y--;
                break;
        
                case 39: // right
                break;
        
                case 40: // down
                player.y++;
                break;
        
                default: return; // exit this handler for other keys
            }
            e.preventDefault(); // prevent the default action (scroll / move caret)
        });
      draw();
    </script>
  </body>
</html>